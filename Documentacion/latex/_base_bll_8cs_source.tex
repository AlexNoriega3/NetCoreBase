\hypertarget{_base_bll_8cs_source}{}\doxysection{Base\+Bll.\+cs}
\label{_base_bll_8cs_source}\index{terravital-\/admin-\/edificios.Bll/commons/BaseBll.cs@{terravital-\/admin-\/edificios.Bll/commons/BaseBll.cs}}
\mbox{\hyperlink{_base_bll_8cs}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00001}00001 \textcolor{keyword}{using} Newtonsoft.Json;}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00002}00002 \textcolor{keyword}{using} \mbox{\hyperlink{namespaceterravital__admin__edificios}{terravital\_admin\_edificios}}.\mbox{\hyperlink{namespaceterravital__admin__edificios_1_1_models}{Models}}.\mbox{\hyperlink{namespaceterravital__admin__edificios_1_1_models_1_1_globals}{Globals}};}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00003}00003 \textcolor{keyword}{using} \mbox{\hyperlink{namespaceterravital__admin__edificios}{terravital\_admin\_edificios}}.\mbox{\hyperlink{namespaceterravital__admin__edificios_1_1_models}{Models}}.\mbox{\hyperlink{namespaceterravital__admin__edificios_1_1_models_1_1_entities}{Entities}};}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00004}00004 \textcolor{keyword}{using} \mbox{\hyperlink{namespaceterravital__admin__edificios}{terravital\_admin\_edificios}}.\mbox{\hyperlink{namespaceterravital__admin__edificios_1_1_bll}{Bll}}.\mbox{\hyperlink{namespaceterravital__admin__edificios_1_1_bll_1_1_factory_services}{FactoryServices}}.\mbox{\hyperlink{namespaceterravital__admin__edificios_1_1_bll_1_1_factory_services_1_1_u_o_w}{UOW}}.\mbox{\hyperlink{namespaceterravital__admin__edificios_1_1_bll_1_1_factory_services_1_1_u_o_w_1_1_interfaces}{Interfaces}};}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00005}00005 \textcolor{keyword}{using} Microsoft.AspNetCore.Mvc;}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00006}00006 \textcolor{keyword}{using} AutoMapper;}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00007}00007 \textcolor{keyword}{using} System.Security.Claims;}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00008}00008 }
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00009}\mbox{\hyperlink{namespaceterravital__admin__edificios_1_1_bll_1_1commons}{00009}} \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceterravital__admin__edificios_1_1_bll_1_1commons}{terravital\_admin\_edificios.Bll.commons}}}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00010}00010 \{}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00011}\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll}{00011}}     \textcolor{keyword}{public} \textcolor{keyword}{class }\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll}{BaseBll}}: ControllerBase}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00012}00012     \{}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00013}\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_ab4c5230f51c37439fb9007ee7ac248e8}{00013}}         \textcolor{keyword}{public} readonly \mbox{\hyperlink{classterravital__admin__edificios_1_1_models_1_1_globals_1_1_global_settings}{GlobalSettings}} \mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_ab4c5230f51c37439fb9007ee7ac248e8}{\_global}};}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00014}\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_a18a6d1a1afedc344ef252a2e1a092393}{00014}}         \textcolor{keyword}{public} readonly \mbox{\hyperlink{interfaceterravital__admin__edificios_1_1_bll_1_1_factory_services_1_1_u_o_w_1_1_interfaces_1_1_iuow_terra_vital}{IuowTerraVital}} \mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_a18a6d1a1afedc344ef252a2e1a092393}{\_UOWTerraVital}};}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00015}\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_a03f3c62d8c2e36decdeca7f4d3755497}{00015}}         \textcolor{keyword}{public} readonly \mbox{\hyperlink{classterravital__admin__edificios_1_1_models_1_1_entities_1_1_app_usuario}{AppUsuario}} \mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_a03f3c62d8c2e36decdeca7f4d3755497}{\_userModel}};}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00016}\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_ac5ce66aaa67daff727a2f4c9d9c0e287}{00016}}         \textcolor{keyword}{public} readonly Serilog.ILogger \mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_ac5ce66aaa67daff727a2f4c9d9c0e287}{\_logger}};}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00017}\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_a306657b20c625a47c8a7c6be35f4a76e}{00017}}         \textcolor{keyword}{public} readonly IMapper \mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_a306657b20c625a47c8a7c6be35f4a76e}{\_mapper}};}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00019}\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_a05af51a407cd7e6a766d57e783c4a53b}{00019}}         \textcolor{keyword}{public} \mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_a05af51a407cd7e6a766d57e783c4a53b}{BaseBll}}()}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00020}00020         \{}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00021}00021             this.\_global = \mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_services}{BaseServices}}.\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_services_a8bf794ae1a43edc6f8147eead737c7ca}{Global}}();}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00022}00022             this.\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_ac5ce66aaa67daff727a2f4c9d9c0e287}{\_logger}} = \mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_services}{BaseServices}}.\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_services_a2177288a01eb916e16724c0b3ced5136}{Logger}}();}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00023}00023             this.\_UOWTerraVital = \textcolor{keyword}{new} \mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_services}{BaseServices}}()}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00024}00024                 .uowTerraVital();}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00025}00025             this.\_mapper = \mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_services}{BaseServices}}.\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_services_a24a09a8abc002891ab77c6b0705ef6c2}{Mapper}}();}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00026}00026 }
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00027}00027             ClaimsPrincipal? user = \mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_services}{BaseServices}}.\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_services_a78eb297c9554ff5860ebd22504ce179f}{Accessor}}().HttpContext?.User;}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00029}00029             \textcolor{keywordflow}{if}(user is not \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00030}00030             \{}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00031}00031                 var claims = user.Claims.Where(c => c.Type == \textcolor{stringliteral}{"{}User"{}})}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00032}00032                     ?.FirstOrDefault();}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00034}00034                 \textcolor{keywordflow}{if} (claims != \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00035}00035                 \{}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00036}00036                     this.\_userModel = JsonConvert.DeserializeObject<\mbox{\hyperlink{classterravital__admin__edificios_1_1_models_1_1_entities_1_1_app_usuario}{AppUsuario}}>(claims.Value);}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00037}00037 }
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00038}00038                     \textcolor{keywordflow}{if}(\mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_a03f3c62d8c2e36decdeca7f4d3755497}{\_userModel}} is not \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00039}00039                     \{}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00040}00040                         this.\_global.UserId = \mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_a03f3c62d8c2e36decdeca7f4d3755497}{\_userModel}}.Id;}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00041}00041                         this.\_global.UserName = \mbox{\hyperlink{classterravital__admin__edificios_1_1_bll_1_1commons_1_1_base_bll_a03f3c62d8c2e36decdeca7f4d3755497}{\_userModel}}.UserName;}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00042}00042                     \}}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00043}00043                 \}}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00044}00044             \}}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00045}00045         \}}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00046}00046     \}}
\DoxyCodeLine{\Hypertarget{_base_bll_8cs_source_l00047}00047 \}}

\end{DoxyCode}
